<!DOCTYPE html>
<html lang="en-zh">

<head>
  <meta charset="UTF-8">
  <title>vue开发文档</title>
  <link rel="icon" href="doc_assets/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
  <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  <link rel="stylesheet" href="./bootstrap-4.5.0-dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="./stylesheets/cm_all.css">
  <style>
    .list-group-item.active {
      z-index: 2;
      color: #fff;
      background-color: #155799;
      border-color: #155799;
    }

    a,
    a:link,
    a:visited,
    a:hover,
    a:active {
      text-decoration: none;
      color: inherit;
    }

    .doc_ul_menu2 {
      padding: 5px;
      margin: 0;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="page-header">
    <h1>2020
      <small>&nbsp;&nbsp;<span class="badge">vue项目,vue-router,vuex,axios</span></small>
    </h1>
  </div>

  <section>
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-2">
          <div id="nav_list" class="list-group cm_mar_t50 cm_pad_20">
            <a class="list-group-item list-group-item-action" href="#list-item-1">概览</a>
            <a class="list-group-item list-group-item-action" href="#list-item-2">起步</a>
            <a class="list-group-item list-group-item-action" href="#list-item-2-1">项目树</a>
            <a class="list-group-item list-group-item-action" href="#list-item-3">依赖/配置</a>
            <a class="list-group-item list-group-item-action" href="#list-item-4">tree-shaking</a>
            <a class="list-group-item list-group-item-action" href="#list-item-999">其他</a>
          </div>
        </div>

        <div class="col-sm-10 col-sm-offset-1 cm_mar_t50">
          <section class="container position-relative">
            <h2>
              <a href="https://github.com/Birght/doc/tree/master/2020">
                Github 地址:</a>
                <a href="https://imgchr.com/i/rQT9fK">
                  <img src="https://s3.ax1x.com/2020/12/16/rQT9fK.png" alt="rQT9fK.png" border="0"  class="cm_img_60"/>
                </a>
            </h2>
            <br>
            <br>
            <br>
            <div data-spy="scroll" data-target="#nav_list" data-offset="0">
              <h4 id="list-item-1">概览，vue特性，脚手架对比</h4>
              <div class="doc_content">
                <p>此文档目标</p>
                <code>
                  构建一个轻量级，编译速度快，组件支持全面，开发效率高效，便捷的vue框架。
                  <br>
                  支持数据定级缓存，响应式布局，多入口启动，浏览器兼容，性能高效
                </code>
                <br>
                <br>
                <p>为什么选择vue-cli?</p>
                <code>
                  vue-cli作为官方脚手架，文档全面，内置了webpack一些配置项，省去冗余的webpack基础配置
                </code>
                <table class="table table-bordered table-condensed table-responsive cm_mar_t10">
                  <thead>
                    <tr>
                      <th>
                        <div class="doc_empty"></div>
                      </th>
                      <th>Vue CLI</th>
                      <th>create-react-app</th>
                      <th>parcel</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>快速原型开发</td>
                      <td>支持</td>
                      <td>-</td>
                      <td>支持</td>
                    </tr>
                    <tr>
                      <td>全局模式</td>
                      <td>零配置原型开发就是全局的</td>
                      <td>-</td>
                      <td>支持</td>
                    </tr>
                    <tr>
                      <td>插件</td>
                      <td>支持</td>
                      <td>-</td>
                      <td>支持，扩展文件类型和文件输出</td>
                    </tr>
                    <tr>
                      <td>扩展性</td>
                      <td>强，通过插件扩展 wepack 配置</td>
                      <td>弱, 强约定, 无法配置 webpack，可以 eject, 然后手工配置；支持 babel-macro;(严格说可以通过<a
                          href="https://github.com/timarney/react-app-rewired" rel="nofollow noreferrer"
                          target="_blank">react-app-rewired</a>进行扩展)</td>
                      <td>中(可以配置 babel，postcss，Typescript); 提供了 Node API; 支持插件扩展文件类型</td>
                    </tr>
                    <tr>
                      <td>多页面</td>
                      <td>支持</td>
                      <td>-</td>
                      <td>支持</td>
                    </tr>
                    <tr>
                      <td>适用范围</td>
                      <td>Vue 组件的第一公民。通过扩展可以支持任意前端框架</td>
                      <td>针对 React 开发，不支持其他框架</td>
                      <td>parcel 是一个通用的打包工具，它的竞争对手是 webpack</td>
                    </tr>
                    <tr>
                      <td>编译速度</td>
                      <td>cache-loader,thread-loader 来加速 JS 和 TS 编译</td>
                      <td>babel-loader 开启了 cache</td>
                      <td>编译速度号称是 webpack 的两倍</td>
                    </tr>
                    <tr>
                      <td>可升级性</td>
                      <td>支持升级 cli-service, 插件需要单独升级, 插件需要遵循语义化版本. 太多插件存在升级风险</td>
                      <td>支持升级 react-script, 官方维护，且强约定基本可以保障向下兼容</td>
                      <td>支持升级 parcel-bundler</td>
                    </tr>
                    <tr>
                      <td>UI</td>
                      <td>图形化管理是 CLI 的特色之一</td>
                      <td>-</td>
                      <td>-</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <h4 id="list-item-2" class="cm_mar_t20">起步</h4>
              <div class="doc_content">
                <pre class="doc_line30">
                    # Node安装，注意
                    最新vue-cli为4.4.6(截至到目前：2020年7月22日)
                    Node版本V10.21
                    Node版本V14启动vue-cli有报错情况

                    # 项目地址
                    git clone git@github.com:Birght/doc.git
                    cd 2020
                    npm install
                    npm run dev
                </pre>
              </div>
              <h4 id="list-item-2-1">项目树</h4>
              <div class="doc_content">
                <pre>
                  # 文件目录树(自动生成文件目录树方式，
                  安装:npm install treer -g,
                  执行:treer -e ./result.txt -i node_modules



                  ├─.eslintrc.js                                -- eslint配置文件
                  ├─index.html                                  -- index入口页面
                  ├─package-lock.json
                  ├─package.json                                -- 依赖
                  ├─README.md                                   -- 文档
                  ├─static                                      -- 非打包静态资源
                  |   └.gitkeep
                  ├─src                                         -- 主目录
                  |  ├─App.vue                                  -- vue入口挂载
                  |  ├─main.js                                  -- vue主入口配置文件
                  |  ├─views                                    -- 开发页面view层
                  |  ├─store                                    -- vuex,数据存储
                  |  ├─router                                   -- 路由配置
                  |  ├─components                               -- 通用组件封装
                  |  ├─common                                   -- 通用文件夹
                  |  |   ├─utils                                -- 常量配置
                  |  |   ├─style                                -- 通用css
                  |  |   ├─public                               -- 通用方法，工具函数，全局注册函数
                  |  ├─assets                                   -- 资源文件夹
                  |  |   ├─svg                                  -- svg文件
                  |  |   ├─images                               -- png文件夹
                  ├─config                                      -- 脚手架配置 
                  |   ├─dev.env.js
                  |   ├─index.js                                
                  |   └─prod.env.js
                  └─build                                       -- webpack编辑/打包配置
                      ├─build.js
                      ├─check-versions.js
                      ├─logo.png
                      ├─utils.js
                      ├─vue-loader.conf.js
                      ├─webpack.base.conf.js
                      ├─webpack.dev.conf.js
                      └─webpack.prod.conf.js
                </pre>
              </div>
              <h4 id="list-item-3">依赖/配置</h4>
              <div class="doc_content">
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                  <div class="doc_panel">
                    <div class="doc_pannel_head" role="tab" id="headingOne">
                      <a class="collapsed doc_w100" role="button" data-toggle="collapse" data-parent="#accordion"
                        href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        1, 增加打包分析 webpack-bundle-analyzer
                      </a>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel"
                      aria-labelledby="headingOne">
                      <div class="doc_panel_body">
                        打包分析:使用交互式可缩放树图可视化webpack输出文件的大小。
                        通过此功能，清晰的查看，编译后，当前项目是哪些文件大，占有率高。
                        根据不同情况做出对应的策略。
                        例如说，编译后发现svg文件过大，入口文件app.xxx.js大于3M等等
                        遇到这种情况，做出对应的处理，svg压缩，文件分片处理。
                        <div class="cm_mar_20">
                          <kbd>使用</kbd>
                        </div>
                        <pre> # 安装依赖<br> npm i webpack-bundle-analyzer</pre>
                        <pre> # 修改 config\index.js下的配置项，bundleAnalyzerReport设置为true，其次在webpac.prod.conf.js中修改如下代码

if (config.build.bundleAnalyzerReport) {
  const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin
  webpackConfig.plugins.push(new BundleAnalyzerPlugin(
    {
      analyzerHost: '127.0.0.1',
      analyzerPort: '9001'
    }
  ))
}
                        </pre>
                      </div>
                    </div>
                  </div>
                  <div class="doc_panel">
                    <div class="doc_pannel_head" role="tab" id="headingTwo">
                      <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                        href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        2, 增加资源服务压缩， compression-webpack-plugin
                      </a>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                      <div class="doc_panel_body">
                        资源服务压缩: 将资源(js/html/svg/png)压缩为符合Content-Encoding:gizp传输格式的文件。
                        <div class="cm_mar_20">
                          <kbd>使用gizp方式进行压缩</kbd>
                        </div>
                        客户端可以事先声明一系列的可以支持压缩模式，与请求一齐发送。 Accept-Encoding 这个首部就是用来进行这种内容编码形式协商的：
                        <p>
                          Accept-Encoding: gzip, deflate
                        </p>
                        服务器在 Content-Encoding 响应首部提供了实际采用的压缩模式：
                        <p>
                          Content-Encoding: gzip
                        </p>
                        需要注意的是，服务器端并不强制要求一定使用何种压缩模式。采用哪种压缩方式高度依赖于服务器端的设置，及其所采用的模块。

                        <div class="cm_mar_20">
                          <kbd>使用</kbd>
                        </div>
                        <pre> # 安装依赖<br> npm i compression-webpack-plugin@1.0.0-beta.1</pre>


                        <pre> # 修改config文件夹下的index.js(文件路径:2020\config\index.js)<br>
更改line:67行，<b>productionGzip: true</b>

                        </pre>

                        <pre> # 修改webpack.prod.conf(文件路径:2020\build\webpack.prod.conf)

if (config.build.productionGzip) {
  const CompressionWebpackPlugin = require('compression-webpack-plugin')

  webpackConfig.plugins.push(
    new CompressionWebpackPlugin({
      asset: '[path].gz[query]',
      algorithm: 'gzip',
      test: new RegExp(
        '\\.(' +
        config.build.productionGzipExtensions.join('|') +
        ')$'
      ),
      threshold: 10240,
      minRatio: 0.8
    })
  )
}
                          </pre>
                        <p>对应后台服务器需要配置gzip，以ngix为例</p>
                        <pre># 在http,server,loaction下加入以下代码，更多查看<a href="https://www.nginx.cn/doc/">ngix文档</a>

gzip_static         on;
gzip_http_version   1.1;
gzip_proxied        expired no-cache no-store private auth;
gzip_disable        "MSIE [1-6]\.";
gzip_vary           on;
                          </pre>
                      </div>
                    </div>
                  </div>
                  <div class="doc_panel">
                    <div class="doc_pannel_head" role="tab" id="headingThree">
                      <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                        href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        3, 增加图片压缩与svg压缩， image-webpack-loader,svg-sprite-loader
                      </a>
                    </div>
                    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel"
                      aria-labelledby="headingThree">
                      <div class="doc_panel_body">
                        image-webpack-loader <br>
                        对于PNG，JPEG，GIF，SVG和WEBP图像进行压缩处理

                        svg-sprite-loader
                        用于创建svg sprite图标

                        每个工程或多或少都会用到图标，开源的UI框架(ElementUI,Ant Design,vant UI) 都提供了一定的基础图标样式，
                        但是不用业务，不同需求，就会有不同的图标需要。此插件就是实现svg文件作为图标使用功能
                        <div class="cm_mar_20">
                          <kbd>使用</kbd>
                        </div>
                        注意点，image-webpack-loader中，添加exclude配置项，
                        （图片压缩不包含assets/icons下的svg) <br>
                        因为image-webpack-loader对于svg处理后，编译后的svg文件由abc.svg => abc.5423ce2343.svg<br>
                        这会引发依赖svg-sprite-loader引入使用的路径错误。<br>
                        所以，在配置svg-sprite-loader过程中，使用include: path.resolve(__dirname, '../src/assets/icons')进行独立压缩处理
                        <pre> # 安装依赖<br>npm i image-webpack-loader,
npm install svg-sprite-loader -D</pre>
                        <pre> # 修改webpack.base.conf.js(文件路径:2020\build\webpack.base.conf)
{
  test: /\.(png|jpe?g|gif|svg)(\?.*)?$/,
  exclude: path.resolve(__dirname, '../src/assets/icons'),
  use: [
    {
      loader: 'url-loader',
      options: {
        limit: 10000,
        name: utils.assetsPath('img/[name].[hash:7].[ext]')
      }
    },
    {
      loader: 'image-webpack-loader',
      options: {
        bypassOnDebug: true
      }
    }
  ]
},
{
  test: /\.svg$/,
  include: path.resolve(__dirname, '../src/assets/icons'),
  use: [
    {
      loader: 'svg-sprite-loader',
      options: {
        symbolId: 'icon-[name]'
      }
    },
    'svg-transform-loader',
    'svgo-loader'
  ]
}
                        </pre>
                      </div>
                    </div>
                  </div>

                  <div class="doc_panel">
                    <div class="doc_pannel_head" role="tab" id="heading4">
                      <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                        href="#collapsefour" aria-expanded="false" aria-controls="collapsefour">
                        4, 删除prod生产环境注释，console,debugger
                      </a>
                    </div>
                    <div id="collapsefour" class="panel-collapse collapse" role="tabpanel"
                      aria-labelledby="heading4">
                      <div class="doc_panel_body">
                        在生产环境中，将删除注释,(/**/),console,debugger,开发环境不受影响
                        <div class="cm_mar_20">
                          <kbd>配置</kbd>
                        </div>
                        <pre> # 修改webpack.base.conf.js(文件路径:2020\build\webpack.prod.conf)
                        </pre>
                        <pre>
new UglifyJsPlugin({
  uglifyOptions: {
    // 删除注释
    output: {
      comments: false
    },
    compress: {
      warnings: false,
      drop_debugger: true,
      drop_console: true,
      pure_funcs: ['console.log']
    }
  },
  sourceMap: config.build.productionSourceMap,
  parallel: true
})
                        </pre>
                      </div>
                    </div>
                  </div>

                  <div class="doc_panel">
                    <div class="doc_pannel_head" role="tab" id="heading5">
                      <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                        href="#collapsefour5" aria-expanded="false" aria-controls="collapsefour5">
                        5, 本地启动编译后的打包文件
                      </a>
                    </div>
                    <div id="collapsefour5" class="panel-collapse collapse" role="tabpanel"
                      aria-labelledby="heading5">
                      <div class="doc_panel_body">
                        本地启动编译后的打包文件
                        <div class="cm_mar_20">
                          <kbd>配置</kbd>
                        </div>
                        <pre>安装依赖：http-server
                        </pre>
                        <pre>
1,npm i vue-http-server
2,cd至dist文件夹
3，执行命令：http-server -p 9001
                        </pre>
                      </div>
                    </div>
                  </div>

                </div>

              </div>
              <h4 id="list-item-4">Tree-Shaking的原理</h4>
              <div class="doc_content" id="list-item-4-0">
                项目中没有使用的代码会在打包时候丢掉。JS 的 Tree Shaking 依赖的是 ES2015 的模块系统（比如：import和export）
              </div>
              <h4 id="list-item-999">其他</h4>
              <div class="doc_content">
                <kbd>本地运行打包dist文件</kbd>
                <br>
                <pre class="cm_mar_t10">
                  1,安装，npm install http-server -g，查看本地打包dist,index.html
                  2,进入dist文件夹: cd dist
                  3,http-server
                </pre>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </section>
  <footer class="site-footer">
    <div class="container">
      <div class="site-footer-owner cm_pad_20"><a href="https://github.com/Birght/doc">作者</a>
        <a href="https://github.com/Birght">@Birght
        </a>
      </div>
    </div>
  </footer>

  <!-- JS, Popper.js, and jQuery -->

  <script src="./bootstrap-4.5.0-dist/js/bootstrap.jquery.js"></script>
  <script src="./bootstrap-4.5.0-dist/js/bootstrap.min.js"></script>
  <script>
    $('body').scrollspy({ target: '#nav_list' })
    $(window).scroll(function () {
      //为了保证兼容性，这里取两个值，哪个有值取哪一个
      //scrollTop就是触发滚轮事件时滚轮的高度
      var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop > 260) {
        $('#nav_list').addClass('doc_list_fiexd')
      } else {
        $('#nav_list').removeClass('doc_list_fiexd')
      }
    })
  </script>
</body>

</html>